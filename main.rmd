
# Set the working directory and load the dataset
```{r}
setwd("ALL CSV FILEs")
data=read.csv("Hotel Reservations.csv",stringsAsFactors = T)
```

# Display dimensions and check for missing values

```{r}
dim(data)
sum(is.na(data))
```
# Summarize the dataset
```{r}
summary(data)
```


# Display structure of the dataset
```{r}
str(data)
```



# Create histograms for selected variables
```{r}
hist(data$required_car_parking_space,col = c("yellowgreen", "yellow"))
hist(data$arrival_year,col = c("skyblue", "pink"))
hist(data$arrival_date, col = c("skyblue",  "pink"))
hist(data$no_of_previous_cancellations, col = c("skyblue",  "red"))
hist(data$no_of_previous_bookings_not_canceled, col = c("skyblue",  "red"))
hist(data$repeated_guest, col = c("yellowgreen",  "skyblue"))
```


# Remove unnecessary columns
```{r}
data1=data[,-c(1,7,10,12,14,15,16)]
head(data1)
```

# Convert arrival month to factor and summarize
```{r}
month_name= c("Jan","Feb","Mar","Apr","May", "June","July","Aug","Sep","Oct","Nov","Dec")
data1$arrival_month=factor(data1$arrival_month,levels = 1:12,labels = month_name)
summary(data1)
```

# Create plots using ggplot2 and gridExtra
```{r}
library(ggplot2)
library(gridExtra)
```


# Plot distribution of adults by cancellation status
```{r}
countplot <- ggplot(data1, aes(x = no_of_adults, fill = booking_status)) +
  geom_bar(position="dodge") +
  labs(x = "", y = "", fill = "Booking Status") +
  geom_text(stat='count', aes(label=after_stat(count)),position=position_dodge(width = 0.85), vjust=-0.2) +
  theme(legend.position = c(0.98, 0.98),
        legend.justification = c(1, 1))
grid.arrange(countplot, ncol = 2, widths = c(2, 1),top="Distribution of adults by Cancellation Status")
```


```{r}
# Calculate frequency of bookings for each number of children
child_fre=table(data1$no_of_children)
# Create a bar plot for the distribution of bookings based on the number of children
text(x=barplot(child_fre,col=rainbow(length(child_fre)),xlab = " No of Children",ylab="No of bookings"),y=child_fre,label=child_fre,pos = 3, cex = 0.8)
# Title for the chart
title(main="Distribution of Number of Children ")
```







# Calculate frequency of bookings for each number of weekend nights
```{r}
wknd_fre = table(data1$no_of_weekend_nights)
```
# Create a bar plot for the distribution of bookings based on the number of weekend nights
```{r}
text(x = barplot(wknd_fre, col = rainbow(length(wknd_fre)), xlab = "No of Weekend Nights", ylab = "No of bookings"), 
     y = wknd_fre, label = wknd_fre, pos = 3, cex = 0.8)
```
# Title for the chart
```{r}
title(main = "Distribution of Weekend Nights")
```




# Calculate frequency of bookings for each number of week nights
```{r}
w_fre = table(data1$no_of_week_nights)
```
# Create a bar plot for the distribution of bookings based on the number of week nights
```{r}
text(x = barplot(w_fre, col = rainbow(length(w_fre)), xlab = "No of Week Nights", ylab = "No of bookings"), 
     y = w_fre, label = w_fre, pos = 3, cex = 0.5)
```
# Title for the chart
```{r}
title(main = "Distribution of Week Nights")
```

# Create a bar plot for the distribution of the type of meal plan by cancellation status
```{r}
countplot <- ggplot(data1, aes(x = type_of_meal_plan, fill = booking_status)) +
  geom_bar(position = "dodge") +  # Use dodge position to place bars side by side
  labs(x = "", y = "", fill = "Booking Status") +
  geom_text(stat = 'count', aes(label = after_stat(count)), position = position_dodge(width = 0.85), vjust = -0.2) +  # Add count labels
  theme(legend.position = c(0.98, 0.98), legend.justification = c(1, 1))  # Position legend
grid.arrange(countplot, ncol = 2, widths = c(2, 1), top = "Distribution of type of Meal Plan by Cancellation Status")
```

# Calculate frequency of each type of meal plan
```{r}
meal_fre = table(data1$type_of_meal_plan)
```
# Create a bar plot for the distribution of bookings based on the type of meal plan
```{r}
text(x = barplot(meal_fre, col = rainbow(length(meal_fre)), xlab = "Type of Meal Plan", ylab = "No of bookings"), 
     y = meal_fre, label = meal_fre, pos = 3, cex = 0.8)
```
# Title for the chart
```{r}
title(main = "Distribution for Type of Meal Plan")
```

# Create a bar plot for the distribution of room types reserved by cancellation status
```{r}
countplot <- ggplot(data1, aes(x = room_type_reserved, fill = booking_status)) +
  geom_bar(position = "dodge") +  # Use dodge position to place bars side by side
  labs(x = " ", y = "", fill = "Booking Status") +
  geom_text(stat = 'count', aes(label = after_stat(count)), position = position_dodge(width = 0.85), vjust = -0.2) +  # Add count labels
  theme(legend.position = c(0.98, 0.98), legend.justification = c(1, 1))  # Position legend
grid.arrange(countplot, ncol = 2, widths = c(2, 1), top = "Distribution of Room Type by Cancellation Status")
```

# Calculate frequency of each room type reserved
```{r}
room_fre = table(data1$room_type_reserved)
```
# Create a bar plot for the distribution of bookings based on room type reserved
```{r}
text(x = barplot(room_fre, col = rainbow(length(room_fre)), las = 2), 
     y = room_fre, label = room_fre, pos = 3, cex = 1)
```
# Title for the chart
```{r}
title(main = "Distribution of Room Type Reserved")
```


```{r}
# Create a histogram to visualize the distribution of lead time
hist(data1$lead_time, col = c("yellowgreen", "skyblue"))
```

```{r}
# Calculate the frequency of bookings by arrival month
month_fre = table(data1$arrival_month)

# Create a bar plot for the distribution of bookings based on arrival month
text(x = barplot(month_fre, col = rainbow(length(month_fre)), xlab = "Arrival Month", ylab = "No of bookings"), 
     y = month_fre, label = month_fre, pos = 1, cex = 0.5)

# Title for the chart
title(main = "Distribution of Arrival Month")
```




```{r}
# Create a bar plot for the distribution of market segment type by booking status
countplot <- ggplot(data1, aes(x = market_segment_type, fill = booking_status)) +
  geom_bar(position = "dodge") +  # Use dodge position to place bars side by side
  labs(x = "", y = "", fill = "Booking Status") +
  geom_text(stat = 'count', aes(label = after_stat(count)), position = position_dodge(width = 0.85), vjust = -0.2) +  # Add count labels
  theme(legend.position = c(0.4, 0.98), legend.justification = c(1, 1))  # Position legend
grid.arrange(countplot, ncol = 2, widths = c(2, 1), top = "Distribution of Market Segment Type by Cancellation Status")
```




```{r}
# Calculate frequency of each market segment type
mark_fre = table(data1$market_segment_type)

# Create a bar plot for the distribution of bookings based on market segment type
text(x = barplot(mark_fre, col = rainbow(length(mark_fre)), xlab = "Market Segment Type", ylab = "No of bookings"), 
     y = mark_fre, label = mark_fre, pos = 3, cex = 0.8)

# Title for the chart
title(main = "Distribution of Market Segment Type")
```




```{r}
# Create a histogram to visualize the distribution of average price per room
hist(data1$avg_price_per_room, col = c("yellowgreen", "skyblue"))
```


```{r}
# Create a bar plot for the distribution of special requests by booking status
countplot <- ggplot(data1, aes(x = no_of_special_requests, fill = booking_status)) +
  geom_bar(position = "dodge") +  # Use dodge position to place bars side by side
  labs(x = "", y = "", fill = "Booking Status") +
  geom_text(stat = 'count', aes(label = after_stat(count)), position = position_dodge(width = 0.85), vjust = -0.2) +  # Add count labels
  theme(legend.position = c(0.98, 0.98), legend.justification = c(1, 1))  # Position legend
grid.arrange(countplot, ncol = 2, widths = c(2, 1), top = "Distribution of Number of Special Requests by Cancellation Status")
```


```{r}
# Calculate the frequency of special requests
rq_fre = table(data1$no_of_special_requests)

# Create a bar plot for the distribution of bookings based on the number of special requests
text(x = barplot(rq_fre, col = rainbow(length(rq_fre)), xlab = "Number of Special Requests", ylab = "No of bookings"), 
     y = rq_fre, label = rq_fre, pos = 3, cex = 1)

# Title for the chart
title(main = "Distribution of Special Requests")
```


```{r}
# Calculate frequency of each booking status (canceled or not)
st_fre = table(data1$booking_status)

# Create a bar plot for the distribution of bookings based on booking status
text(x = barplot(st_fre, col = c("pink", "yellowgreen"), xlab = "Cancelled Status", ylab = "No of bookings"), 
     y = st_fre, label = st_fre, pos = 1, cex = 1)

# Title for the chart
title(main = "Distribution of Booking Status")
```


```{r}
# Create a boxplot to compare lead time by booking status
boxplot(data1$lead_time ~ data1$booking_status, col = c("skyblue", "yellowgreen"))
```



```{r}
# Create a boxplot to compare arrival month by booking status
boxplot(data1$arrival_month ~ data1$booking_status, col = c("pink", "lightskyblue"))
```


```{r}
# Create a boxplot to compare the number of special requests by booking status
boxplot(data1$no_of_special_requests ~ data1$booking_status, col = c("pink", "green4"))
```


```{r}
# Fit a logistic regression model using all predictors to predict 'booking_status'
log_reg1 = glm(data1$booking_status ~ ., data = data1, family = "binomial")

# View the summary of the logistic regression model
summary(log_reg1)
```





# Split the dataset into training and testing sets
```{r}
# First 29,000 rows go to training data
train_data1 = data1[1:29000,]

# Remaining rows (29,001 to 36,275) go to testing data
test_data1 = data1[29001:36275,]
```



```{r}
# Fit logistic regression model on training data
log_reg2 = glm(booking_status ~ ., data = train_data1, family = "binomial")

# Get the number of observations in test set
n1 = nrow(test_data1)

# Create a vector of default predictions as "Canceled"
log_reg_resp2 = rep("Canceled", n1)

# Get predicted probabilities for "Not_Canceled" class
log_reg_probs2 = predict(log_reg2, test_data1, type = "response")

# If probability > 0.5, predict "Not_Canceled", else remain "Canceled"
log_reg_resp2[log_reg_probs2 > 0.5] = "Not_Canceled"
```





```{r}
# Print confusion matrix
print("Logistic Regression Confusion Matrix")
table(log_reg_resp2, test_data1$booking_status)
```


```{r}
# Example of accuracy and error rate calculation from confusion matrix values:
# Here: 944 = True Negative, 525 = False Negative, 1461 = False Positive, 4345 = True Positive
# Accuracy = (TP + TN) / Total
c = (944 + 4345) / (1461 + 525 + 944 + 4345)
d = 1 - c

cat("Accuracy:", c, "\n")
cat("Testing error rate:", d, "\n")
```



```{r}
# Alternate approach using manually entered accuracy
print("Logistic Regression Confusion Matrix")
table(log_reg_resp2, test_data1$booking_status)

a = 0.7981  # Manually given accuracy
b = 1 - a   # Error rate
cat("Accuracy:", a, "\n")
cat("Testing error rate:", b, "\n")
```









```{r}
# Load MASS library for Linear Discriminant Analysis (LDA)
library(MASS)

# Train LDA model using training data
lda_model1 = lda(booking_status ~ ., data = train_data1)

# Predict booking_status on the test data
lda_preds1 = predict(lda_model1, test_data1)

# Print confusion matrix for LDA with default threshold (0.5)
print("LDA Confusion Matrix")
table(lda_preds1$class, test_data1$booking_status)

# Calculate testing error and accuracy for default LDA predictions
test_error_lda1 <- mean(lda_preds1$class != test_data1$booking_status)
cat("Accuracy:", 1 - test_error_lda1, "\n")
cat("Testing error rate:", test_error_lda1, "\n")
```



```{r}
# --------- LDA with 0.3 threshold ---------
# Initialize all predictions to "Not_Canceled"
n = nrow(test_data1)
lda_thr = rep("Not_Canceled", n)

# Change prediction to "Canceled" if posterior probability > 0.3
thr_index = lda_preds1$posterior[,"Canceled"] > 0.3
lda_thr[thr_index] = "Canceled"

# Print confusion matrix for LDA with 0.3 threshold
print("LDA with 0.3 Confusion Matrix")
table(lda_thr, test_data1$booking_status)

# Calculate accuracy and testing error rate
cat("Accuracy:", mean(lda_thr == test_data1$booking_status), "\n")
cat("Testing error rate:", 1 - mean(lda_thr == test_data1$booking_status), "\n")

```




```{r}

# --------- LDA with 0.4 threshold ---------
# Initialize all predictions to "Not_Canceled"
lda_thr1 = rep("Not_Canceled", n)

# Change prediction to "Canceled" if posterior probability > 0.4
thr_index1 = lda_preds1$posterior[,"Canceled"] > 0.4
lda_thr1[thr_index1] = "Canceled"

# Print confusion matrix for LDA with 0.4 threshold
print("LDA with 0.4 Confusion Matrix")
table(lda_thr1, test_data1$booking_status)

# Calculate accuracy and testing error rate
cat("Accuracy:", mean(lda_thr1 == test_data1$booking_status), "\n")
cat("Testing error rate:", 1 - mean(lda_thr1 == test_data1$booking_status), "\n")

```



```{r}


```




```{r}


```



```{r}


```




```{r}


```



```{r}


```




```{r}


```



```{r}


```